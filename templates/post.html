{% extends "base.html" %}
{% block title %}{{post['title']}}{% endblock %}
{% block body %}
	<div style="margin-left: 15%; margin-right: 15%; margin-top: 2%;">
		<h1>{{post['title']}}</h1>
		{% if url %}
			<img src="{{url}}" alt="{{post['file']}}" height="50%" width="50%">
		{% endif %}
		<p>{% for c in post['body'] %}{% if c == '\n'%}<br>{% endif %}{{c}}{% endfor %}</p>
		{% if download %}
			@{{post['username']}} have attached <a href="{{download}}" class="a" download>this </a> file to the post.
		{% endif %}
		<div>This post was published on {{post['pub_date']}} {% if group %} in <a href="/{{group['_id']}}-group" class="link">{{group['name']}}</a> {% endif %} by <a href="/{{_id}}" class="link">@{{post['username']}}</a>.</div><br>
		{% if likeable %}
			<button onclick="like();" class="none_button" id="like">👍Like ({{post['likes']}})</button>
		{% else %}
			👍Liked by {{post['likes']}} users.
		{% endif %}
		{% if saveable %}
			<button onclick="save();" class="none_button" id="save">📝Save ({{post['saved']}})</button>
		{% else %}
			📝Saved by {{post['saved']}} users.
		{% endif %}
		<a href="/share-{{post['_id']}}" class="a">Share post</a><br>
		<hr>
		<form action="/add-comment-{{post['_id']}}" method="POST">
			<textarea name="text" placeholder="Add a public comment" rows="3" style="border-radius: 10px; width: 100%;"></textarea>
			<button class="l">Add</button>
		</form>
		<hr>
		<span>
			{% for comment in comments %}
				<br>
				<a class="link" href="/{{comment['user_id']}}">@{{comment['username']}}</a> {{comment['pub_date']}} {% if comment in delete %}<a href="/delete-comment-{{comment['_id']}}" class="d">Delete Comment</a>{% endif %}<br>
				{% for c in comment['text'] %}{% if c == '\n'%}<br>{% endif %}{{c}}{% endfor %}<br>
			{% endfor %}
		</span>
	</div>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script>
		function like() {
			$.get("/{{post['_id']}}-like", function(data) {
				document.getElementById("like").innerHTML = "👍Liked by " + data + " users. ";
			});
		}
		function save() {
			$.get("/{{post['_id']}}-save", function(data) {
				document.getElementById("save").innerHTML = "📝Saved by " + data + " users.";
			});
		}
	</script>
{% endblock %}
